# خطة تطوير المكتبة الإسلامية الذكية
## Development Roadmap v2.0

---

## 🔴 المشاكل الحالية (يجب إصلاحها أولاً)

### 1. مشكلة عرض التصنيفات
**الوصف:** التصنيفات تظهر في عمود واحد بدلاً من شبكة
**الحل:** تعديل CSS لـ `.categories-grid` ليعمل كشبكة أفقية
```css
.categories-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 أعمدة */
    gap: 20px;
}
```

---

## ✨ الميزات الجديدة المطلوبة

---

### 📚 المرحلة الأولى: نظام التبويبات المتعددة

#### 1.1 فتح أكثر من كتاب في نفس الصفحة
**الوصف:** إمكانية فتح عدة كتب في تبويبات متجاورة

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  [📖 الكافي ×] [📖 بحار الأنوار ×] [📖 الصحيفة ×] [➕]      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────────┬─────────────────┐                    │
│   │    الكتاب 1     │    الكتاب 2     │                    │
│   │                 │                 │                    │
│   │   [المحتوى]     │   [المحتوى]     │                    │
│   │                 │                 │                    │
│   └─────────────────┴─────────────────┘                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**الملفات المطلوبة:**
- `js/tabs-manager.js` - إدارة التبويبات
- تحديث `book.html` لدعم التبويبات
- تحديث `css/components.css` لأنماط التبويبات

**الوظائف:**
- فتح كتاب جديد في تبويب
- إغلاق تبويب
- سحب وإفلات لترتيب التبويبات
- تقسيم الشاشة (عمودي/أفقي)
- مزامنة التمرير بين كتابين

---

#### 1.2 حفظ المشاريع (Workspaces)
**الوصف:** حفظ حالة العمل الحالية للرجوع إليها لاحقاً

**التصميم:**
```
┌──────────────────────────────────────┐
│  💼 مشاريعي                          │
├──────────────────────────────────────┤
│  ┌────────────────────────────────┐  │
│  │ 📁 مقارنة أحاديث الصلاة        │  │
│  │    📖 الكافي - باب الصلاة      │  │
│  │    📖 التهذيب - كتاب الطهارة   │  │
│  │    📝 ملاحظاتي...              │  │
│  │    🕐 آخر تعديل: اليوم         │  │
│  └────────────────────────────────┘  │
│                                      │
│  ┌────────────────────────────────┐  │
│  │ 📁 بحث في العقائد              │  │
│  │    📖 بحار الأنوار             │  │
│  │    📝 تقرير التوحيد            │  │
│  └────────────────────────────────┘  │
│                                      │
│  [➕ مشروع جديد]                     │
└──────────────────────────────────────┘
```

**البيانات المحفوظة:**
```javascript
{
  id: "workspace-001",
  name: "مقارنة أحاديث الصلاة",
  createdAt: "2024-01-15",
  updatedAt: "2024-01-16",
  tabs: [
    { bookId: "kafi", section: "ch2-s1", scrollPosition: 450 },
    { bookId: "tahdhib", section: "ch1-s1", scrollPosition: 200 }
  ],
  layout: "split-horizontal",
  notes: "ملاحظاتي...",
  reports: ["report-001"]
}
```

---

### 🤖 المرحلة الثانية: ميزات الذكاء الاصطناعي المتقدمة

#### 2.1 مركز الذكاء الاصطناعي (AI Hub)
**الوصف:** صفحة/قسم مخصص لجميع ميزات AI مع تصميم مميز

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│     ╔═══════════════════════════════════════════════╗      │
│     ║  ✨🤖 مركز الذكاء الاصطناعي                   ║      │
│     ╚═══════════════════════════════════════════════╝      │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │     ⭐      │  │     ⭐      │  │     ⭐      │        │
│  │   تلخيص    │  │   شرح      │  │  محادثة    │        │
│  │   الكتاب   │  │   النص     │  │   ذكية    │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │     ⭐      │  │     ⭐      │  │     ⭐      │        │
│  │  البحث     │  │   جلب      │  │  مقارنة    │        │
│  │  الذكي     │  │   النصوص   │  │   النصوص   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  💬 المحادثات السابقة                               │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │  • تلخيص كتاب الكافي - منذ ساعة                    │   │
│  │  • شرح حديث الكساء - منذ يومين                     │   │
│  │  • البحث عن أحاديث الإمامة - منذ أسبوع             │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**الملفات المطلوبة:**
- `ai-hub.html` - صفحة مركز AI
- `js/ai-hub.js` - منطق المركز
- `css/ai-hub.css` - أنماط خاصة بتأثيرات مميزة

---

#### 2.2 تلخيص الكتاب الكامل
**الوصف:** زر لتلخيص الكتاب بالكامل أو فصل معين

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  ⭐ تلخيص الكتاب                                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📖 الكافي - الشيخ الكليني                                  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  اختر نطاق التلخيص:                                 │   │
│  │                                                     │   │
│  │  ○ الكتاب كاملاً                                   │   │
│  │  ○ الفصل الحالي فقط                                │   │
│  │  ○ القسم الحالي فقط                                │   │
│  │  ○ الصفحة الحالية                                  │   │
│  │                                                     │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │  نوع التلخيص:                                      │   │
│  │  ○ ملخص مختصر (فقرة واحدة)                         │   │
│  │  ○ ملخص متوسط (نقاط رئيسية)                        │   │
│  │  ○ ملخص تفصيلي (شامل)                              │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  [✨ ابدأ التلخيص]                                          │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  📝 الملخص:                                                 │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │  كتاب الكافي هو أحد أهم المصادر الحديثية عند       │   │
│  │  الشيعة الإمامية، جمعه الشيخ الكليني على مدى      │   │
│  │  عشرين عاماً...                                    │   │
│  │                                                     │   │
│  │  النقاط الرئيسية:                                  │   │
│  │  • يتناول العقل والعلم                            │   │
│  │  • يشمل أحاديث التوحيد                            │   │
│  │  • يتضمن أبواب الفقه                              │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  [📋 نسخ] [📥 تصدير PDF] [💾 حفظ في المشروع]               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

#### 2.3 أين ورد هذا النص؟ (Text Finder)
**الوصف:** تحديد نص والبحث عن أماكن وروده في جميع الكتب

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  🔍 أين ورد هذا النص؟                                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  النص المحدد:                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  "إنما يريد الله ليذهب عنكم الرجس أهل البيت"        │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ⏳ جاري البحث في 300 كتاب...                              │
│  ████████████░░░░░░░░ 60%                                   │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  📊 النتائج: وُجد في 47 موضع                               │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📖 الكافي                                          │   │
│  │    ├─ كتاب الحجة، باب 12 ─ [فتح]                   │   │
│  │    └─ كتاب الإيمان، باب 5 ─ [فتح]                  │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ 📖 بحار الأنوار                                    │   │
│  │    ├─ المجلد 23، ص 234 ─ [فتح]                     │   │
│  │    ├─ المجلد 35، ص 12 ─ [فتح]                      │   │
│  │    └─ المجلد 37، ص 89 ─ [فتح]                      │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ 📖 تفسير الميزان                                   │   │
│  │    └─ سورة الأحزاب، الآية 33 ─ [فتح]               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  [📊 تصدير النتائج] [🔗 فتح الكل في تبويبات]               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**آلية العمل:**
1. المستخدم يحدد نص
2. تظهر قائمة منبثقة: [شرح] [تلخيص] [أين ورد؟] [نسخ]
3. عند اختيار "أين ورد" يتم البحث في جميع الكتب
4. عرض النتائج مع إمكانية الفتح المباشر

---

#### 2.4 جلب النصوص بالأمر (Smart Fetch)
**الوصف:** كليك يمين > "اجلب لي..." > يكتب ما يريد

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  ✨ جلب نص                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ماذا تريد أن أجلب لك؟                                      │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  حديث الكساء                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  [⭐ جلب]                                                   │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  ✅ تم العثور على النص:                                     │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  بسم الله الرحمن الرحيم                            │   │
│  │                                                     │   │
│  │  روي عن فاطمة الزهراء عليها السلام أنها قالت:      │   │
│  │  دخل عليّ أبي رسول الله صلى الله عليه وآله في      │   │
│  │  بعض الأيام فقال: السلام عليك يا فاطمة...          │   │
│  │  ...                                               │   │
│  │  [عرض النص الكامل]                                 │   │
│  │                                                     │   │
│  │  📚 المصدر: بحار الأنوار، ج35، ص206                │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  [📋 نسخ] [📥 إدراج في التقرير] [🔗 فتح المصدر]            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**أمثلة على الطلبات:**
- "حديث الكساء"
- "آية التطهير"
- "دعاء كميل"
- "زيارة عاشوراء"
- "خطبة الغدير"
- "حديث الثقلين"

---

#### 2.5 المحادثة الذكية (AI Chat)
**الوصف:** محادثة مع AI حول محتوى الكتب

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  💬 المحادثة الذكية                              [─] [□] [×]│
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │  👤 أنت: ما هي شروط الوضوء في الفقه الجعفري؟       │   │
│  │                                                     │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                     │   │
│  │  🤖 المساعد:                                       │   │
│  │                                                     │   │
│  │  شروط الوضوء في الفقه الجعفري هي:                  │   │
│  │                                                     │   │
│  │  1. النية                                          │   │
│  │  2. غسل الوجه                                      │   │
│  │  3. غسل اليدين من المرفقين                         │   │
│  │  4. مسح الرأس                                      │   │
│  │  5. مسح الرجلين                                    │   │
│  │                                                     │   │
│  │  📚 المصادر:                                       │   │
│  │  • تهذيب الأحكام، كتاب الطهارة [فتح]              │   │
│  │  • الكافي، كتاب الطهارة [فتح]                     │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  اكتب سؤالك هنا...                          [إرسال]│   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  💡 اقتراحات: [ما حكم...] [اشرح لي...] [قارن بين...]      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

### 📝 المرحلة الثالثة: نظام التقارير والكتابة

#### 3.1 محرر التقارير (Report Editor)
**الوصف:** صفحة لكتابة تقارير وأبحاث مع إمكانية جلب النصوص

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  📝 محرر التقارير                                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  العنوان: [بحث في أحاديث الإمامة                        ]   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [B] [I] [U] │ [H1] [H2] │ [📖 جلب نص] │ [🔗 رابط]  │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │  # مقدمة                                           │   │
│  │                                                     │   │
│  │  في هذا البحث سنتناول أحاديث الإمامة الواردة      │   │
│  │  عن النبي صلى الله عليه وآله وسلم...              │   │
│  │                                                     │   │
│  │  ## حديث الغدير                                    │   │
│  │                                                     │   │
│  │  ┌───────────────────────────────────────────┐     │   │
│  │  │ 📜 اقتباس من: الكافي                      │     │   │
│  │  │                                           │     │   │
│  │  │ "من كنت مولاه فهذا علي مولاه..."         │     │   │
│  │  │                                           │     │   │
│  │  │ [🔗 المصدر] [✏️ تعديل] [🗑️ حذف]           │     │   │
│  │  └───────────────────────────────────────────┘     │   │
│  │                                                     │   │
│  │  هذا الحديث يدل على...                            │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  [💾 حفظ] [📥 تصدير Word] [📥 تصدير PDF] [🖨️ طباعة]        │
│                                                             │
│  📊 الإحصائيات: 1,234 كلمة │ 5 اقتباسات │ 3 مصادر          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**الميزات:**
- محرر نصوص غني (Rich Text Editor)
- إدراج اقتباسات من الكتب مع المصدر التلقائي
- جلب نصوص بالأمر (اجلب لي...)
- تصدير بصيغ متعددة (Word, PDF, HTML)
- حفظ تلقائي
- قائمة المصادر التلقائية
- فهرس آلي

---

#### 3.2 قائمة السياق الذكية (Smart Context Menu)
**الوصف:** كليك يمين على أي نص يظهر قائمة خيارات

**التصميم:**
```
        ┌────────────────────────────┐
        │  📋 نسخ                    │
        │  ─────────────────────────  │
        │  ⭐ شرح هذا النص           │
        │  ⭐ تلخيص                  │
        │  ⭐ أين ورد؟               │
        │  ─────────────────────────  │
        │  📖 جلب نص مشابه           │
        │  🔗 البحث في Google        │
        │  ─────────────────────────  │
        │  📝 إضافة للتقرير          │
        │  🔖 إضافة علامة            │
        │  💬 مناقشة مع AI           │
        └────────────────────────────┘
```

---

### 📱 المرحلة الرابعة: تحسين واجهة الموبايل

#### 4.1 التصميم الجديد للموبايل

**الشاشة الرئيسية:**
```
┌─────────────────────┐
│  ☰  المكتبة    🌙  │
├─────────────────────┤
│                     │
│  ┌───────────────┐  │
│  │ 🔍 ابحث...   │  │
│  └───────────────┘  │
│                     │
│  التصنيفات          │
│  ┌─────┬─────┐     │
│  │ ⚖️  │ 🕌  │     │
│  │فقه │عقائد│     │
│  ├─────┼─────┤     │
│  │ 📖  │ 📚  │     │
│  │تفسير│حديث│     │
│  └─────┴─────┘     │
│                     │
│  الكتب المميزة      │
│  ┌─────────────┐   │
│  │   📕        │   │
│  │  الكافي    │   │
│  │  الكليني   │   │
│  └─────────────┘   │
│                     │
├─────────────────────┤
│ 🏠  📚  🤖  👤     │
└─────────────────────┘
```

**صفحة القراءة (موبايل):**
```
┌─────────────────────┐
│  ←  الكافي     ⋮   │
├─────────────────────┤
│                     │
│  كتاب العقل والجهل │
│  ─────────────────  │
│                     │
│  روي عن الإمام     │
│  الصادق عليه       │
│  السلام أنه قال:   │
│                     │
│  "العقل ما عُبد به │
│  الرحمن واكتُسب    │
│  به الجنان"...     │
│                     │
│                     │
│                     │
│                     │
├─────────────────────┤
│  ◀️  1/50  ▶️       │
├─────────────────────┤
│ 📑  Aa  ⭐  💬  ⋮  │
└─────────────────────┘

شريط الأدوات السفلي:
📑 = الفهرس
Aa = حجم الخط
⭐ = AI
💬 = محادثة
⋮ = المزيد
```

**قائمة AI (موبايل):**
```
┌─────────────────────┐
│                     │
│   ╔═══════════════╗ │
│   ║  ⭐ المساعد   ║ │
│   ╚═══════════════╝ │
│                     │
│  ┌───────────────┐  │
│  │ 📝 تلخيص     │  │
│  └───────────────┘  │
│  ┌───────────────┐  │
│  │ 💡 شرح       │  │
│  └───────────────┘  │
│  ┌───────────────┐  │
│  │ 🔍 أين ورد؟  │  │
│  └───────────────┘  │
│  ┌───────────────┐  │
│  │ 💬 محادثة    │  │
│  └───────────────┘  │
│  ┌───────────────┐  │
│  │ 📖 جلب نص    │  │
│  └───────────────┘  │
│                     │
│      [إغلاق]        │
└─────────────────────┘
```

---

### 🎨 المرحلة الخامسة: التحسينات البصرية

#### 5.1 تأثيرات مميزة لقسم AI

**التصميم:**
- خلفية متدرجة متحركة
- أيقونات متوهجة
- تأثيرات نجوم متطايرة
- حدود متوهجة

```css
/* مثال على التأثيرات */
.ai-feature-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 2px solid transparent;
    animation: glow 2s ease-in-out infinite;
}

.ai-star {
    animation: twinkle 1.5s ease-in-out infinite;
}

@keyframes glow {
    0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.5); }
    50% { box-shadow: 0 0 40px rgba(102, 126, 234, 0.8); }
}
```

#### 5.2 الرسوم المتحركة

- انتقالات سلسة بين الصفحات
- تأثيرات عند فتح الكتاب
- تأثيرات تحميل مخصصة
- Micro-interactions

---

## 📋 ملخص الملفات المطلوبة

### ملفات جديدة:
```
islamic-library/
├── ai-hub.html              # مركز الذكاء الاصطناعي
├── workspace.html           # صفحة المشاريع
├── report-editor.html       # محرر التقارير
├── css/
│   ├── ai-effects.css       # تأثيرات AI الخاصة
│   └── mobile-enhanced.css  # تحسينات الموبايل
└── js/
    ├── tabs-manager.js      # إدارة التبويبات
    ├── workspace.js         # إدارة المشاريع
    ├── text-finder.js       # البحث عن النصوص
    ├── smart-fetch.js       # جلب النصوص
    ├── report-editor.js     # محرر التقارير
    ├── ai-chat.js           # المحادثة الذكية
    └── context-menu.js      # قائمة السياق
```

### ملفات يجب تحديثها:
- `index.html` - إصلاح شبكة التصنيفات + روابط AI
- `book.html` - إضافة التبويبات وقائمة السياق
- `css/components.css` - مكونات جديدة
- `css/responsive.css` - تحسينات الموبايل
- `js/ai-features.js` - توسيع الميزات
- `js/data.js` - بيانات إضافية

---

## 🗓️ ترتيب التنفيذ المقترح

### المرحلة 1 (الأساسيات):
1. ✅ إصلاح مشكلة عرض التصنيفات
2. إنشاء قائمة السياق الذكية
3. تحسين ميزات AI الحالية

### المرحلة 2 (الميزات الأساسية):
4. نظام "أين ورد هذا النص"
5. جلب النصوص بالأمر
6. مركز AI

### المرحلة 3 (المتقدمة):
7. نظام التبويبات المتعددة
8. حفظ المشاريع
9. محرر التقارير

### المرحلة 4 (التحسينات):
10. واجهة الموبايل المحسنة
11. التأثيرات البصرية
12. المحادثة الذكية

---

## 📝 ملاحظات للمطور

1. **قابلية التوسع:** جميع الميزات يجب أن تكون modular
2. **الأداء:** استخدام lazy loading للكتب الكبيرة
3. **التخزين:** استخدام IndexedDB للمشاريع والتقارير
4. **API:** تجهيز واجهات للربط مع خدمات AI خارجية
5. **الوصولية:** دعم قارئات الشاشة واختصارات لوحة المفاتيح

---

**تاريخ الإنشاء:** 2024
**الإصدار:** 2.0
**الحالة:** خطة جاهزة للتنفيذ
