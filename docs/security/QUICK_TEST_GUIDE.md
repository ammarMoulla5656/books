# ๐งช ุฏููู ุงูุงุฎุชุจุงุฑ ุงูุณุฑูุน - ุงููุตุงุฏูุฉ

**ุงููุฏู**: ุงุฎุชุจุงุฑ ุญูุงูุฉ ุฌููุน ุฑูุงุจุท ุงูุฅุฏุงุฑุฉ ุจุนุฏ ุชุทุจูู ุงููุตุงุฏูุฉ
**ุงูููุช ุงูููุฏุฑ**: 10-15 ุฏูููุฉ

---

## ๐ ุงููุชุทูุจุงุช

1. **ุงูุฎุงุฏู ูุนูู**: `npm run dev` (ุงููููุฐ 3000)
2. **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: PostgreSQL ูุชุตูุฉ
3. **ุญุณุงุจ Admin**: ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. **ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ**:
   - `curl` (ุณุทุฑ ุงูุฃูุงูุฑ)
   - ุฃู Postman
   - ุฃู Thunder Client (VS Code)

---

## ๐ ุงูุงุฎุชุจุงุฑ ุงูุณุฑูุน (5 ุฏูุงุฆู)

### ุงูุฎุทูุฉ 1: ุงุฎุชุจุงุฑ ุจุฏูู ูุตุงุฏูุฉ (ูุฌุจ ุฃู ููุดู)

```bash
# ุฌููุน ูุฐู ุงูุทูุจุงุช ูุฌุจ ุฃู ุชุฑุฌุน 401 Unauthorized

# 1. Seed (ุญุฐู DB)
curl -X POST http://localhost:3000/api/admin/seed

# 2. Upload document
curl -X POST http://localhost:3000/api/admin/documents

# 3. Import books
curl -X POST http://localhost:3000/api/admin/import-sistani

# ุงููุชูุฌุฉ ุงููุชููุนุฉ ูุฌููุน ุงูุทูุจุงุช:
# Status: 401
# Body: {"error":"Unauthorized. Admin authentication required.","code":"UNAUTHORIZED","timestamp":"..."}
```

### ุงูุฎุทูุฉ 2: ุชุณุฌูู ุงูุฏุฎูู

```bash
# ุงุญูุธ ุงูู cookies ูู ููู
curl -X POST http://localhost:3000/api/admin/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@islamic-library.com",
    "password": "YOUR_PASSWORD_HERE"
  }' \
  -c cookies.txt \
  -v

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# Status: 200
# Headers: Set-Cookie: admin_session=...
# Body: {"success":true,"admin":{...}}
```

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ูุน ุงููุตุงุฏูุฉ (ูุฌุจ ุฃู ููุฌุญ)

```bash
# ุงุณุชุฎุฏู ุงูู cookies ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ

# 1. Seed (ุงูุขู ูุฌุจ ุฃู ูุนูู)
curl -X POST http://localhost:3000/api/admin/seed \
  -b cookies.txt

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# Status: 200
# Body: {"success":true,"message":"..."}

# 2. Get documents
curl -X GET http://localhost:3000/api/admin/documents \
  -b cookies.txt

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# Status: 200
# Body: {"uploads":[...],"total":...}
```

---

## ๐ ุงูุงุฎุชุจุงุฑ ุงูุดุงูู (15 ุฏูููุฉ)

### ูุงุฆูุฉ ูุญุต ูุงููุฉ

| # | Endpoint | Method | ุจุฏูู auth | ูุน auth |
|---|----------|--------|-----------|---------|
| 1 | `/api/admin/seed` | POST | โ 401 | โ 200 |
| 2 | `/api/admin/documents` | GET | โ 401 | โ 200 |
| 3 | `/api/admin/documents` | POST | โ 401 | โ 200 |
| 4 | `/api/admin/documents/[id]` | GET | โ 401 | โ 200/404 |
| 5 | `/api/admin/documents/[id]` | DELETE | โ 401 | โ 200/404 |
| 6 | `/api/admin/documents/[id]/status` | GET | โ 401 | โ 200/404 |
| 7 | `/api/admin/documents/[id]/toc` | GET | โ 401 | โ 200/404 |
| 8 | `/api/admin/documents/[id]/toc` | PUT | โ 401 | โ 200/404 |
| 9 | `/api/admin/documents/[id]/confirm` | POST | โ 401 | โ 200/404 |
| 10 | `/api/admin/import-sistani` | POST | โ 401 | โ 200 |
| 11 | `/api/admin/scrape-book/[bookId]` | GET | โ 401 | โ 200/404 |
| 12 | `/api/admin/scrape-book/[bookId]` | POST | โ 401 | โ 200/404 |
| 13 | `/api/admin/scrape-book-enhanced/[bookId]` | POST | โ 401 | โ 200/404 |
| 14 | `/api/admin/books/abx` | POST | โ 401 | โ 200/400 |

### ูุตุงุฆุญ ุงูุงุฎุชุจุงุฑ

1. **ุงุณุชุฎุฏู ID ุตุญูุญ**: ุนูุฏ ุงุฎุชุจุงุฑ `/documents/[id]`ุ ุงุณุชุฎุฏู ID ููุฌูุฏ
2. **404 vs 200**: ุจุนุถ ุงูู endpoints ูุฏ ุชุฑุฌุน 404 ุฅุฐุง ูู ููู ุงููุงุฆู ููุฌูุฏุงู (ูุฐุง ุทุจูุนู)
3. **ูููุงุช ุงูุงุฎุชุจุงุฑ**: ูุงุฎุชุจุงุฑ ุฑูุน ุงููููุงุชุ ุงุณุชุฎุฏู ูููุงุช ุตุบูุฑุฉ
4. **Cookies**: ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ููุณ ููู cookies ูู ุฌููุน ุงูุทูุจุงุช

---

## ๐ ุงุฎุชุจุงุฑ ุงูุชุณุฌูู (Logging)

### ุงูุฎุทูุฉ 1: ูุญุงููุฉ ูุตูู ุบูุฑ ูุตุฑุญ

```bash
# ุญุงูู ุงููุตูู ุจุฏูู ูุตุงุฏูุฉ
curl -X POST http://localhost:3000/api/admin/seed
```

### ุงูุฎุทูุฉ 2: ุชุญูู ูู ุงูู logs

ุงูุชุญ terminal ุงูุฎุงุฏู (`npm run dev`) ูุงุจุญุซ ุนู:

```
[SECURITY] Unauthorized admin access attempt: {
  endpoint: '/api/admin/seed',
  ip: '::1',
  reason: 'No valid session',
  timestamp: '2026-01-20T...',
  userAgent: 'curl/...'
}
```

### ุงูุชุญูู

- โ ูุธูุฑ log ุนูุฏ ูู ูุญุงููุฉ ุบูุฑ ูุตุฑุญ
- โ ูุญุชูู ุนูู IP address
- โ ูุญุชูู ุนูู endpoint
- โ ูุญุชูู ุนูู timestamp
- โ ูุญุชูู ุนูู user agent

---

## ๐ฏ ุงูุณููุงุฑูููุงุช ุงููููุฉ

### ุณููุงุฑูู 1: ูุญุงููุฉ ุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
# ุจุฏูู ูุตุงุฏูุฉ (ูุฌุจ ุฃู ููุดู)
curl -X POST http://localhost:3000/api/admin/seed

# ูุน ูุตุงุฏูุฉ (ููุฌุญ - ุงุญุฐุฑ!)
curl -X POST http://localhost:3000/api/admin/seed -b cookies.txt
```

**โ๏ธ ุชุญุฐูุฑ**: ุงูุทูุจ ุงูุซุงูู ุณูุญุฐู ูุฅุนุงุฏุฉ ุจูุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช!

### ุณููุงุฑูู 2: ุฑูุน ููู ABX

```bash
# ุจุฏูู ูุตุงุฏูุฉ (ูุฌุจ ุฃู ููุดู)
curl -X POST http://localhost:3000/api/admin/books/abx \
  -F "file=@test.abx"

# ูุน ูุตุงุฏูุฉ (ููุฌุญ)
curl -X POST http://localhost:3000/api/admin/books/abx \
  -F "file=@test.abx" \
  -b cookies.txt
```

### ุณููุงุฑูู 3: ุงุณุชูุฑุงุฏ ูุชุจ

```bash
# ุจุฏูู ูุตุงุฏูุฉ (ูุฌุจ ุฃู ููุดู)
curl -X POST http://localhost:3000/api/admin/import-sistani

# ูุน ูุตุงุฏูุฉ (ููุฌุญ)
curl -X POST http://localhost:3000/api/admin/import-sistani \
  -b cookies.txt
```

---

## ๐ ูุนุงููุฑ ุงููุฌุงุญ

### โ ุงูุงุฎุชุจุงุฑ ูุงุฌุญ ุฅุฐุง:

1. **ุฌููุน ุงูุทูุจุงุช ุจุฏูู ูุตุงุฏูุฉ ุชุฑุฌุน 401**
2. **ุฌููุน ุงูุทูุจุงุช ูุน ูุตุงุฏูุฉ ุตุญูุญุฉ ุชูุฌุญ**
3. **ุฑุณุงุฆู ุงูุฎุทุฃ ูุงุถุญุฉ ูููุณูุฉ**
4. **ุงูู logs ุชุณุฌู ุงููุญุงููุงุช ุบูุฑ ุงููุตุฑุญ ุจูุง**
5. **ุงูู cookies ุชุนูู ุจุดูู ุตุญูุญ**

### โ ุงูุงุฎุชุจุงุฑ ูุงุดู ุฅุฐุง:

1. **ุฃู ุทูุจ ุจุฏูู ูุตุงุฏูุฉ ููุฌุญ**
2. **ุฃู ุทูุจ ูุน ูุตุงุฏูุฉ ุตุญูุญุฉ ููุดู**
3. **ูุง ููุฌุฏ logs ูููุญุงููุงุช ุบูุฑ ุงููุตุฑุญ ุจูุง**
4. **ุฑุณุงุฆู ุงูุฎุทุฃ ุบูุฑ ูุงุถุญุฉ**

---

## ๐ ูุนุงูุฌุฉ ุงููุดุงูู

### ุงููุดููุฉ 1: 401 ุญุชู ูุน ุชุณุฌูู ุฏุฎูู ุตุญูุญ

**ุงูุณุจุจ ุงููุญุชูู**: ุงูู cookies ูู ูุชู ุญูุธูุง ุฃู ุฅุฑุณุงููุง

**ุงูุญู**:
```bash
# ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู -c ูุญูุธ cookies
curl ... -c cookies.txt

# ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู -b ูุฅุฑุณุงู cookies
curl ... -b cookies.txt

# ุชุญูู ูู ูุญุชูู ููู cookies
cat cookies.txt
```

### ุงููุดููุฉ 2: 500 Internal Server Error

**ุงูุณุจุจ ุงููุญุชูู**: ุฎุทุฃ ูู ุงูููุฏ ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ูุชุตูุฉ

**ุงูุญู**:
```bash
# ุชุญูู ูู logs ุงูุฎุงุฏู
# ุชุญูู ูู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
# ุชุญูู ูู ุฃู ุฌููุน ุงูุญููู ุงููุทููุจุฉ ููุฌูุฏุฉ
```

### ุงููุดููุฉ 3: ูุง ุชุธูุฑ logs

**ุงูุณุจุจ ุงููุญุชูู**: ูุณุชูู ุงูู logging ุฎุงุทุฆ

**ุงูุญู**:
```bash
# ุชุฃูุฏ ูู ุฃู console.warn() ูุนูู
# ุชุญูู ูู ุฅุนุฏุงุฏุงุช Next.js logging
```

---

## ๐ ูููุฐุฌ ุชูุฑูุฑ ุงูุงุฎุชุจุงุฑ

```markdown
# ุชูุฑูุฑ ุงุฎุชุจุงุฑ ุงููุตุงุฏูุฉ

**ุงูุชุงุฑูุฎ**:
**ุงููุฎุชุจุฑ**:
**ุงููุณุฎุฉ**:

## ุงููุชุงุฆุฌ

### ุงุฎุชุจุงุฑ ุจุฏูู ูุตุงุฏูุฉ
- [ ] `/api/admin/seed` - 401 โ
- [ ] `/api/admin/documents` (GET) - 401 โ
- [ ] `/api/admin/documents` (POST) - 401 โ
- [ ] `/api/admin/import-sistani` - 401 โ
- [ ] `/api/admin/books/abx` - 401 โ
- [ ] ... (ุฃููู ุงููุงุฆูุฉ)

### ุงุฎุชุจุงุฑ ูุน ูุตุงุฏูุฉ
- [ ] ุชุณุฌูู ุฏุฎูู ูุงุฌุญ โ
- [ ] `/api/admin/seed` - 200 โ
- [ ] `/api/admin/documents` (GET) - 200 โ
- [ ] ... (ุฃููู ุงููุงุฆูุฉ)

### ุงุฎุชุจุงุฑ Logging
- [ ] ูุธูุฑ log ุนูุฏ ูุญุงููุฉ ุบูุฑ ูุตุฑุญ โ
- [ ] ูุญุชูู ุนูู IP โ
- [ ] ูุญุชูู ุนูู timestamp โ

## ุงูููุงุญุธุงุช

(ุฃุถู ุฃู ููุงุญุธุงุช ุฃู ูุดุงูู ููุง)

## ุงูุฎูุงุตุฉ

โ ุงูุงุฎุชุจุงุฑ ูุงุฌุญ / โ ูุญุชุงุฌ ุฅุตูุงุญ
```

---

## ๐ ูุตุงุฆุญ ุฅุถุงููุฉ

### ุงุณุชุฎุฏุงู Postman

1. ุฃูุดุฆ Collection ุฌุฏูุฏุฉ
2. ุฃุถู ุฌููุน ุงูู endpoints
3. ุงุณุชุฎุฏู Environment variables ููู base URL
4. Postman ูุญูุธ cookies ุชููุงุฆูุงู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

### ุงุณุชุฎุฏุงู Thunder Client (VS Code)

1. ุงูุชุญ Thunder Client ูู sidebar
2. ุฃูุดุฆ Collection
3. ุฃุถู ุงูู endpoints
4. ุงุณุชุฎุฏู Environment ููู variables

### ุงุณุชุฎุฏุงู Browser DevTools

1. ุงูุชุญ Network tab
2. ุณุฌู ุฏุฎูู ุนุจุฑ ุงููุงุฌูุฉ
3. ุดุงูุฏ ุงูู cookies ูู Application tab
4. ุฌุฑุจ API endpoints ูู Console

---

**ุงูุญุงูุฉ**: โ **ุฌุงูุฒ ููุงุฎุชุจุงุฑ**
**ุขุฎุฑ ุชุญุฏูุซ**: 20 ููุงูุฑ 2026
