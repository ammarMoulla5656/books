# ๐ ููุฎุต ุญู ุงููุดููุฉ ุงูุฎุงูุณุฉ

## ุงููุดููุฉ ๐ด
**ุงูุชุญูู ุงูุถุนูู ูู ุงููููุงุช ุงููุฑููุนุฉ**

- ูุญุต MIME type ููุท (ููุฒูุฑ ุจุณูููุฉ)
- ุญุฏ 100MB ูุจูุฑ ุฌุฏุงู
- ูุง ููุฌุฏ ุชูุธูู ููุฃุณูุงุก
- ูุง ูุญุต ููุญุชูู ุงูููู ุงูุญูููู

## ุงูุญู โ

### 1. ููุชุจุฉ ุดุงููุฉ ุฌุฏูุฏุฉ: `lib/file-validation.ts`

#### โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:

**๐ ูุญุต Magic Bytes**
```typescript
PDF:  [0x25, 0x50, 0x44, 0x46] โ %PDF
DOCX: [0x50, 0x4b, 0x03, 0x04] โ PK.. (ZIP)
ABX:  ZIP ุฃู XML
```
- **ูููุน**: ุชุฒููุฑ ููุน ุงูููู (exe โ pdf)
- **ููู**: ููุฑุฃ ุฃูู 16 ุจุงูุช ูููุงุฑููุง

**๐งน ุชูุธูู ุงูุฃุณูุงุก**
```typescript
"../../etc/passwd.pdf" โ "_etc_passwd.pdf"
"file<>.pdf"          โ "file__.pdf"
"ููู ุงูุณูุณุชุงูู.pdf"  โ "ููู_ุงูุณูุณุชุงูู.pdf" โ
```
- **ูููุน**: Path traversalุ command injection
- **ูุญูุธ**: ุงูุฃุญุฑู ุงูุนุฑุจูุฉ

**๐ ุฃุณูุงุก ุขููุฉ ูุฑูุฏุฉ**
```typescript
"document.pdf" โ "1768600145280_a7f9k2_document.pdf"
```
- **ูููุน**: ุชุตุงุฏู ุงูุฃุณูุงุกุ ุงุณุชุจุฏุงู ูููุงุช
- **ูููุฑ**: ุชุชุจุน ุณููุ ูุฑุงุฏุฉ

**๐ ุญุฏ ุงูุญุฌู**
```typescript
50MB max (ุชูููู ูู 100MB)
```
- **ูููุน**: DoSุ ุงุณุชูุฒุงู ุงูููุงุฑุฏ

**๐ฆ ูุญุต ุงูููุฑูุณุงุช (Placeholder)**
```typescript
scanForViruses() // ุฌุงูุฒ ููุฏูุฌ ูุน ClamAV
```

---

### 2. ุชุทุจูู ูู API: `app/api/admin/documents/route.ts`

**ูุจู:**
```typescript
// ูุญุต ุจุณูุท
if (!allowedTypes.includes(file.type)) {
  return error;
}
```

**ุจุนุฏ:**
```typescript
// ูุญุต ุดุงูู (10 ุทุจูุงุช)
const validation = await validateUploadedFile(file);
if (!validation.valid) {
  logFileSecurityEvent('validation_failed', {...});
  return error with details;
}
```

---

## ๐ ุงูุชุฃุซูุฑ

### ุทุจูุงุช ุงูุญูุงูุฉ

```
ูุจู: 2 ุทุจูุฉ ููุท
ุจุนุฏ: 10 ุทุจูุงุช ุฃูุงู

โ 1. ูุญุต ุงูุงูุชุฏุงุฏ
โ 2. ูุญุต ุงูุญุฌู (50MB)
โ 3. ูุญุต MIME type
โ 4. ูุญุต Magic Bytes (ุญุงุณู!)
โ 5. ูุทุงุจูุฉ ุงูููุน
โ 6. ุชูุธูู ุงูุงุณู
โ 7. ุชูููุฏ ุงุณู ุขูู
โ 8. ูุญุต Path
โ 9. ูุญุต ุงูููุฑูุณุงุช
โ 10. ุชุณุฌูู ุฃููู
```

### ุงููุฌูุงุช ุงููุญูู ูููุง

| ุงููุฌูู | ูุจู | ุจุนุฏ |
|--------|-----|-----|
| File Type Spoofing | โ | โ |
| MIME Type Spoofing | โ | โ |
| Path Traversal | โ๏ธ | โ |
| Null Byte Injection | โ | โ |
| DoS (ูููุงุช ุถุฎูุฉ) | โ | โ |
| Unicode Attacks | โ | โ |

---

## ๐ ุงููููุงุช

### ุฌุฏูุฏ
- โจ `lib/file-validation.ts` (450+ ุณุทุฑ)
- ๐ `docs/security/FILE_VALIDATION_SOLUTION.md`
- ๐งช `docs/security/FILE_VALIDATION_TESTING.md`

### ููุนุฏูู
- ๐ง `app/api/admin/documents/route.ts`

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

```bash
# ุฑูุน ููู ุตุญูุญ
curl -X POST /api/admin/documents \
  -F "file=@document.pdf"
# โ ูููุจู

# ุฑูุน ููู ูุฒูุฑ
mv virus.exe fake.pdf
curl -X POST /api/admin/documents \
  -F "file=@fake.pdf"
# โ ููุฑูุถ (magic bytes ุฎุงุทุฆุฉ)
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

1. **ุฏูุฌ ClamAV** ููุญุต ููุฑูุณุงุช ุญูููู
2. **Deep Inspection** ููุญุต ูุญุชูู PDF/DOCX
3. **Rate Limiting** ูููุน ูุฌูุงุช Brute Force

---

## โ ุงูุญุงูุฉ

**ุงููุดููุฉ 5**: โ **ูุญูููุฉ ุจุงููุงูู**

- ุงูุชุญูู ุงูุดุงูู: โ
- Magic Bytes: โ
- ุชูุธูู ุงูุฃุณูุงุก: โ
- ุญุฏ ุงูุญุฌู: โ
- ุงูุชูุซูู: โ
- ุงูุงุฎุชุจุงุฑุงุช: โ

---

**ููุชูุงุตูู ุงููุงููุฉ**: ุฑุงุฌุน [FILE_VALIDATION_SOLUTION.md](./FILE_VALIDATION_SOLUTION.md)
