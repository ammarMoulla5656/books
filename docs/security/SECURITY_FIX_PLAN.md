# ๐ ุฎุทุฉ ุฅุตูุงุญ ุงููุดุงูู ุงูุฃูููุฉ ุงูุญุฑุฌุฉ

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ุงููุดุงูู ุงูุญุฑุฌุฉ](#ุงููุดุงูู-ุงูุญุฑุฌุฉ)
3. [ุฎุทุฉ ุงูุชูููุฐ ุงููุฑุญููุฉ](#ุฎุทุฉ-ุงูุชูููุฐ-ุงููุฑุญููุฉ)
4. [ุงูุฃููููุงุช](#ุงูุฃููููุงุช)
5. [ูุชุทูุจุงุช ุงูุชูููุฐ](#ูุชุทูุจุงุช-ุงูุชูููุฐ)
6. [ุฌุฏูู ุฒููู ููุชุฑุญ](#ุฌุฏูู-ุฒููู-ููุชุฑุญ)
7. [ุงุฎุชุจุงุฑ ูุง ุจุนุฏ ุงูุชูููุฐ](#ุงุฎุชุจุงุฑ-ูุง-ุจุนุฏ-ุงูุชูููุฐ)

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

### ุงููุฏู
ุฅุตูุงุญ **7 ุซุบุฑุงุช ุฃูููุฉ ุญุฑุฌุฉ** ูู ุชุทุจูู ุงูููุชุจุฉ ุงูุฅุณูุงููุฉ ุจุทุฑููุฉ ููุธูุฉ ูุขููุฉ.

### ุงูุฎุทูุฑุฉ
- **๐ด ุญุฑุฌุฉ ุฌุฏุงู**: 3 ูุดุงูู (ูููุงุช ูุฑูุฑุ ุตูุงุญูุงุชุ ุฌูุณุงุช)
- **๐ ุญุฑุฌุฉ**: 2 ูุดููุฉ (ูููุงุชุ ูุงุนุฏุฉ ุจูุงูุงุช)
- **๐ก ูููุฉ**: 2 ูุดููุฉ (ุญุฏูุฏุ CORS)

### ุงูุฃุซุฑ
- **ูุจู ุงูุฅุตูุงุญ**: ุงูุชุทุจูู ุนูุฑุถุฉ ููุงุฎุชุฑุงู ุงููุงูู
- **ุจุนุฏ ุงูุฅุตูุงุญ**: ุญูุงูุฉ ุดุงููุฉ ูู ูุนุธู ุงููุฌูุงุช ุงูุดุงุฆุนุฉ

---

## ๐ด ุงููุดุงูู ุงูุญุฑุฌุฉ

### ุงููุดููุฉ 1: ูููุฉ ูุฑูุฑ Admin ููุชูุจุฉ ูู ุงูููุฏ ๐ด๐ด๐ด

**ุงูุฎุทูุฑุฉ**: ุญุฑุฌุฉ ุฌุฏุงู - ุฃู ุดุฎุต ููููู ุงููุตูู ููููุฏ ูุนุฑู ูููุฉ ุงููุฑูุฑ

**ุงููููุงุช ุงููุชุฃุซุฑุฉ**:
- `/lib/auth.ts` (ุณุทุฑ 21)
- `/app/api/admin/seed/route.ts` (ุณุทุฑ 58)
- `/prisma/seed.ts`
- `/scripts/create-admin.ts`

**ูููุฉ ุงููุฑูุฑ ุงูููุดููุฉ**: `Admin@123456`

**ุงูุญู ุงููุทููุจ**:
1. โ ุฅุฒุงูุฉ ุฌููุน ูููุงุช ุงููุฑูุฑ ุงูููุชูุจุฉ
2. โ ุชูููุฏ ูููุฉ ูุฑูุฑ ุนุดูุงุฆูุฉ ุขููุฉ
3. โ ุญูุธูุง ูู ูุชุบูุฑ ุจูุฆุฉ `ADMIN_INITIAL_PASSWORD`
4. โ ุฅุฌุจุงุฑ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุนูุฏ ุฃูู ุชุณุฌูู ุฏุฎูู
5. โ ุชุณุฌูู ุงูุชุญุฐูุฑุงุช ูู ุงูุณุฌูุงุช

**ุงูุฃููููุฉ**: ๐ด ููุฑูุฉ

---

### ุงููุดููุฉ 2: ูุง ุชูุฌุฏ ูุตุงุฏูุฉ ุนูู ุฑูุงุจุท ุงูุฅุฏุงุฑุฉ ๐ด๐ด๐ด

**ุงูุฎุทูุฑุฉ**: ุญุฑุฌุฉ ุฌุฏุงู - ุฃู ุดุฎุต ููููู ุงููุตูู ูุฑูุงุจุท API ููุฅุฏุงุฑุฉ

**ุงูุฑูุงุจุท ุงูููุดููุฉ**:
- `/app/api/admin/seed/route.ts` - ุฅุนุงุฏุฉ ุจูุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช!
- `/app/api/admin/books/abx/route.ts` - ุฑูุน ูููุงุช
- `/app/api/admin/documents/route.ts` - ุฅุฏุงุฑุฉ ุงููุณุชูุฏุงุช
- `/app/api/admin/import-sistani/route.ts` - ุงุณุชูุฑุงุฏ ุจูุงูุงุช
- `/app/api/admin/scrape-book/[bookId]/route.ts` - ุงุณุชุฎุฑุงุฌ ูุชุจ

**ุงูุญู ุงููุทููุจ**:
1. โ ุฅูุดุงุก middleware ููุชุญูู ูู ุงููุตุงุฏูุฉ
2. โ ุฅุถุงูุฉ ูุญุต `getAdminSession()` ููู ุฑุงุจุท
3. โ ุฅุฑุฌุงุน 401 Unauthorized ุฅุฐุง ูู ููู ูุตุงุฏู
4. โ ุชุทุจูู ุงูููุท ุนูู **ุฌููุน** ุฑูุงุจุท `/api/admin/*`

**ูุซุงู ุงูููุฏ ุงููุทููุจ**:
```typescript
export async function POST(request: NextRequest) {
  const session = await getAdminSession();
  if (!session) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }
  // ... ุจุงูู ุงูููุฏ
}
```

**ุงูุฃููููุฉ**: ๐ด ููุฑูุฉ

---

### ุงููุดููุฉ 3: ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ูู ุงูุฐุงูุฑุฉ ๐ด๐ด

**ุงูุฎุทูุฑุฉ**: ุญุฑุฌุฉ - ุงูุฌูุณุงุช ุชูููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุณูุฑูุฑ

**ุงููุดุงูู ุงูุญุงููุฉ** ูู `/lib/session.ts`:
- โ ุงูุฌูุณุงุช ูุญููุธุฉ ูู `Map` ูู ุงูุฐุงูุฑุฉ
- โ ูุง ููุฌุฏ ูุญุต ุงูุชูุงุก ุตูุงุญูุฉ
- โ UUID ุบูุฑ ุขูู ุจูุง ูููู
- โ ูุง ููุฌุฏ ุญุฐู ุชููุงุฆู ููุฌูุณุงุช ุงูููุชููุฉ

**ุงูุญู ุงููุทููุจ**:
1. โ ุญูุธ ุงูุฌูุณุงุช ูู PostgreSQL
2. โ ุฅุถุงูุฉ `expiresAt` timestamp (24 ุณุงุนุฉ ุงูุชุฑุงุถูุงู)
3. โ ุงุณุชุฎุฏุงู tokens ุนุดูุงุฆูุฉ ุขููุฉ
4. โ ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ูู ุทูุจ
5. โ ุญุฐู ุงูุฌูุณุงุช ุงูููุชููุฉ ุชููุงุฆูุงู
6. โ ุขููุฉ ุชุฌุฏูุฏ ุงูุฌูุณุฉ

**Schema ุงููุทููุจ**:
```prisma
model AdminSession {
  id        String   @id @default(cuid())
  token     String   @unique
  adminId   String
  admin     Admin    @relation(fields: [adminId], references: [id], onDelete: Cascade)
  expiresAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("admin_sessions")
}
```

**ุงูุฃููููุฉ**: ๐ด ููุฑูุฉ

---

### ุงููุดููุฉ 4: ุซุบุฑุฉ Path Traversal ูู ุงููููุงุช ๐๐

**ุงูุฎุทูุฑุฉ**: ุญุฑุฌุฉ - ูููู ุญุฐู ุฃู ููู ูู ุงูุณูุฑูุฑ

**ุงูููุฏ ุงูุฎุทูุฑ** ูู `/app/api/admin/documents/[id]/route.ts` (ุณุทุฑ 92):
```typescript
const upload = await prisma.documentUpload.findUnique({ where: { id } });
await unlink(upload.storagePath); // ุฎุทุฑ! ูุณุชุฎุฏู ุงููุณุงุฑ ูู DB ูุจุงุดุฑุฉ
```

**ุงูุณููุงุฑูู ุงูุฎุทูุฑ**:
1. ููุงุฌู ูุนุฏูู `storagePath` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ูุถุน ูุณุงุฑ ูุซู: `../../etc/passwd`
3. ุนูุฏ ุญุฐู ุงููุณุชูุฏุ ููุญุฐู ููู ุงููุธุงู!

**ุงูุญู ุงููุทููุจ**:
1. โ ุงูุชุญูู ูู ุฃู ุงููุณุงุฑ ุฏุงุฎู ูุฌูุฏ `uploads/`
2. โ ุงุณุชุฎุฏุงู `path.resolve()` ููุชุญูู
3. โ ุฑูุถ ุฃู ูุณุงุฑ ุฎุงุฑุฌ ุงููุฌูุฏ ุงููุณููุญ
4. โ ุชุทุจูู ููุณ ุงูุญูุงูุฉ ุนูู **ุฌููุน** ุนูููุงุช ุงููููุงุช

**ูุซุงู ุงูููุฏ ุงูุขูู**:
```typescript
import path from 'path';

const uploadsDir = path.resolve(process.cwd(), 'uploads');
const filePath = path.resolve(upload.storagePath);

// ุชุญูู ุฃู ุงูููู ุฏุงุฎู uploads
if (!filePath.startsWith(uploadsDir)) {
  throw new Error('Invalid file path');
}

await unlink(filePath);
```

**ุงูุฃููููุฉ**: ๐ ุนุงุฌูุฉ

---

### ุงููุดููุฉ 5: ุงูุชุญูู ุงูุถุนูู ูู ุงููููุงุช ุงููุฑููุนุฉ โ ูุญูููุฉ

**ุงูุฎุทูุฑุฉ**: ุญุฑุฌุฉ - ูููู ุฑูุน ูููุงุช ุฎุจูุซุฉ

**ุงููุดุงูู ุงูุฃุตููุฉ** ูู `/app/api/admin/documents/route.ts`:
- โ ููุญุต ููุท MIME type (ูููู ุชุฒููุฑู ูู ุงููุชุตูุญ)
- โ ูุง ููุญุต ูุญุชูู ุงูููู ุงูุญูููู (magic bytes)
- โ ุญุฏ 100MB ูุจูุฑ ุฌุฏุงู
- โ ูุง ููุฌุฏ ุชูุธูู ูุงุณู ุงูููู
- โ ูุง ููุฌุฏ ูุญุต ููุฑูุณุงุช

**โ ุงูุญู ุงูููุทุจูู**:
1. โ **ุชู** - ูุญุต magic bytes ููููู (PDFุ DOCXุ ABX)
2. โ **ุชู** - ุชูุธูู ุดุงูู ูุฃุณูุงุก ุงููููุงุช (path traversalุ null bytesุ ุฃุญุฑู ุฎุงุตุฉ)
3. โ **ุชู** - ุชูููุฏ ุฃุณูุงุก ุขููุฉ ูุฑูุฏุฉ (timestamp_random_name)
4. โ **ุชู** - ุชูููู ุงูุญุฏ ุฅูู 50MB
5. โ **ุชู** - placeholder ุฌุงูุฒ ููุญุต ุงูููุฑูุณุงุช (ClamAV)
6. โ **ุฅุถุงูู** - 10 ุทุจูุงุช ุฃูุงู ุดุงููุฉ
7. โ **ุฅุถุงูู** - ุชุณุฌูู ุงูุฃุญุฏุงุซ ุงูุฃูููุฉ ูุน IP

**ุงููููุงุช ุงููููุดุฃุฉ**:
- โ `lib/file-validation.ts` - ููุชุจุฉ ุดุงููุฉ (450+ ุณุทุฑ)
- โ `docs/security/FILE_VALIDATION_SOLUTION.md` - ุชูุซูู ูุงูู
- โ `docs/security/FILE_VALIDATION_TESTING.md` - ุฏููู ุงูุงุฎุชุจุงุฑ
- โ `docs/security/PROBLEM_5_SUMMARY.md` - ููุฎุต ุณุฑูุน

**ุงููููุงุช ุงูููุนุฏููุฉ**:
- โ `app/api/admin/documents/route.ts` - ุชุทุจูู ุงูุชุญูู ุงูุดุงูู

**ุงูุฃููููุฉ**: โ **ุชู ุงูุญู ุจุงููุงูู** (20 ููุงูุฑ 2026)

---

### ุงููุดููุฉ 6: ุจูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุดููุฉ โ ูุญูููุฉ

**ุงูุฎุทูุฑุฉ**: ูููุฉ - ุจูุงูุงุช ุงูุงุชุตุงู ูุงูุช ููุดููุฉ

**ุงููุดููุฉ ุงูุฃุตููุฉ**:
```env
DATABASE_URL="postgresql://postgres:iioopp00@localhost:5432/islamic_library"
```

- โ ูููุฉ ุงููุฑูุฑ ุถุนููุฉ (`iioopp00`)
- โ ูุง ููุฌุฏ `.env.example` ุดุงูู
- โ ูุง ููุฌุฏ ุชุญูู ูู ุงููุชุบูุฑุงุช
- โ ูุง ููุฌุฏ ุฏููู ูุชูููุฏ ููู ุขููุฉ

**โ ุงูุญู ุงูููุทุจูู**:
1. โ **ุชู** - ุชุญุฏูุซ `.env.example` ุจุฌููุน ุงููุชุบูุฑุงุช ูุดุฑูุญุงุช ููุตูุฉ
2. โ **ุชู** - ุงูุชุญูู ูู `.gitignore` (`.env*` ููุฌูุฏ)
3. โ **ุชู** - ุงูุชุญูู ูู Git history (ูุง ุชูุฌุฏ ุจูุงูุงุช ุญุณุงุณุฉ)
4. โ **ุชู** - ุฏุงูุฉ `validateEnvironmentVariables()` ููุชุญูู ุงูุชููุงุฆู
5. โ **ุชู** - script `generate-env-secrets.ts` ูุชูููุฏ ูููุงุช ูุฑูุฑ ุขููุฉ
6. โ **ุชู** - ุชูุซูู ุดุงูู ูู `ENV_SETUP.md`
7. โ **ุฅุถุงูู** - ุฃูุงูุฑ NPM: `npm run generate-secrets`, `npm run validate-env`
8. โ **ุฅุถุงูู** - ุฏุนู AWS/Azure Secrets Manager

**ุงููููุงุช ุงููููุดุฃุฉ**:
- โ `lib/env-validator.ts` - ุฏุงูุฉ ุงูุชุญูู ูู ุงููุชุบูุฑุงุช (260+ ุณุทุฑ)
- โ `scripts/generate-env-secrets.ts` - script ุชูููุฏ ูููุงุช ูุฑูุฑ (310+ ุณุทุฑ)
- โ `docs/security/ENV_SETUP.md` - ุฏููู ุฅุนุฏุงุฏ ุดุงูู
- โ `docs/security/PROBLEM_6_SUMMARY.md` - ููุฎุต ุงูุญู

**ุงููููุงุช ุงูููุนุฏููุฉ**:
- โ `.env.example` - ุฅุถุงูุฉ `PYTHON_SERVICE_URL` ูุชุญุณููุงุช
- โ `package.json` - ุฅุถุงูุฉ ุฃูุงูุฑ `generate-secrets` ู `validate-env`

**ุงูุฃููููุฉ**: โ **ุชู ุงูุญู ุจุงููุงูู** (20 ููุงูุฑ 2026)

---

### ุงููุดููุฉ 7: ูุง ููุฌุฏ Rate Limiting ููุง CORS โ ูุญูููุฉ

**ุงูุฎุทูุฑุฉ**: ูููุฉ - ูููู ุฅุบุฑุงู ุงูุณูุฑูุฑ ุจุงูุทูุจุงุช

**ุงููุดุงูู ุงูุฃุตููุฉ**:
- โ ูุง ููุฌุฏ ุญุฏ ูุนุฏุฏ ุงูุทูุจุงุช
- โ ุฃู ูููุน ููููู ุงุณุชุฏุนุงุก API
- โ ูุง ุชูุฌุฏ headers ุฃูููุฉ
- โ ูุง ููุฌุฏ ุญูุงูุฉ ูู ุงููุฌูุงุช ุงูุดุงุฆุนุฉ

**โ ุงูุญู ุงูููุทุจูู**:
1. โ **ุชู** - Rate Limiting: 100 ุทูุจ / 15 ุฏูููุฉ ููู IP
2. โ **ุชู** - CORS: ูุทุงูุงุช ูุญุฏุฏุฉ ููุท (localhost + production)
3. โ **ุชู** - Security Headers: 6 headers ุดุงููุฉ
   - HSTS (production)
   - X-Frame-Options: DENY
   - Content-Security-Policy
   - X-Content-Type-Options: nosniff
   - Referrer-Policy
   - X-XSS-Protection
4. โ **ุชู** - Attack Detection: SQL Injection, XSS, Path Traversal, Command Injection
5. โ **ุชู** - IP Blocking: ุญุธุฑ ุชููุงุฆู ุจุนุฏ 3 ูุญุงููุงุช ูุดุจููุฉ
6. โ **ุฅุถุงูู** - ุชุณุฌูู ุฌููุน ุงูุฃุญุฏุงุซ ุงูุฃูููุฉ
7. โ **ุฅุถุงูู** - ุชูุธูู ุชููุงุฆู ููุจูุงูุงุช ุงููุฏููุฉ

**ุงููููุงุช ุงููููุดุฃุฉ**:
- โ `middleware.ts` - ุงูููู ุงูุฑุฆูุณู (~250 ุณุทุฑ)
- โ `tests/security/test-rate-limit.js` - ุณูุฑูุจุช ุงุฎุชุจุงุฑ ุจุณูุท
- โ `tests/security/rate-limiting.test.ts` - ุงุฎุชุจุงุฑุงุช Jest
- โ `docs/security/RATE_LIMITING_SOLUTION.md` - ุชูุซูู ุดุงูู
- โ `docs/security/PROBLEM_7_SUMMARY.md` - ููุฎุต ุณุฑูุน

**ุงููููุงุช ุงูููุนุฏููุฉ**:
- โ `.env.example` - ุฅุถุงูุฉ ูุชุบูุฑุงุช ุงูุฃูุงู ูุงูู CORS

**ุงูุฃููููุฉ**: โ **ุชู ุงูุญู ุจุงููุงูู** (20 ููุงูุฑ 2026)

---

## ๐ ุฎุทุฉ ุงูุชูููุฐ ุงููุฑุญููุฉ

### ุงููุฑุญูุฉ 1: ุงูุฅุตูุงุญุงุช ุงูููุฑูุฉ (ููู 1) ๐ด

**ุงููุฏู**: ุฅุตูุงุญ ุงูุซุบุฑุงุช ุงูุฃุฎุทุฑ ุงูุชู ูููู ุงุฎุชุฑุงููุง ููุฑุงู

#### 1.1 ุฅุตูุงุญ ูููุงุช ุงููุฑูุฑ (2-3 ุณุงุนุงุช)
- [ ] ุฅุฒุงูุฉ `Admin@123456` ูู ุฌููุน ุงููููุงุช
- [ ] ุชูููุฏ ูููุฉ ูุฑูุฑ ุนุดูุงุฆูุฉ
- [ ] ุฅุถุงูุฉ `ADMIN_INITIAL_PASSWORD` ุฅูู `.env`
- [ ] ููุฒุฉ ุฅุฌุจุงุฑ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
- [ ] **ุงููููุงุช**: `lib/auth.ts`, `app/api/admin/seed/route.ts`, `prisma/seed.ts`, `scripts/create-admin.ts`

#### 1.2 ุฅุถุงูุฉ ูุตุงุฏูุฉ ููุฑูุงุจุท (3-4 ุณุงุนุงุช)
- [ ] ุฅูุดุงุก middleware ูููุตุงุฏูุฉ
- [ ] ุฅุถุงูุฉ ูุญุต `getAdminSession()` ููู ุฑุงุจุท admin
- [ ] ุงุฎุชุจุงุฑ ุฌููุน ุงูุฑูุงุจุท
- [ ] **ุงููููุงุช**: ุฌููุน ูููุงุช `/app/api/admin/**/*.ts`

#### 1.3 ููู ุงูุฌูุณุงุช ููุงุนุฏุฉ ุงูุจูุงูุงุช (4-5 ุณุงุนุงุช)
- [ ] ุชุญุฏูุซ Prisma Schema ุจุฌุฏูู `AdminSession`
- [ ] ุชุดุบูู migration
- [ ] ุฅุนุงุฏุฉ ูุชุงุจุฉ `/lib/session.ts`
- [ ] ุงุฎุชุจุงุฑ ุฅูุดุงุก ูุญุฐู ุงูุฌูุณุงุช
- [ ] **ุงููููุงุช**: `prisma/schema.prisma`, `lib/session.ts`

**ูุฌููุน ุงูููุช**: ~10 ุณุงุนุงุช

---

### ุงููุฑุญูุฉ 2: ุญูุงูุฉ ุงููููุงุช (ููู 2) ๐

**ุงููุฏู**: ุญูุงูุฉ ุนูููุงุช ุงููููุงุช ูู ุงูุซุบุฑุงุช

#### 2.1 ุฅุตูุงุญ Path Traversal (2-3 ุณุงุนุงุช)
- [ ] ุฅูุดุงุก ุฏุงูุฉ `validateFilePath()`
- [ ] ุชุทุจูููุง ุนูู ุฌููุน ุนูููุงุช ุงููููุงุช
- [ ] ุงุฎุชุจุงุฑ ูุน ูุณุงุฑุงุช ุฎุจูุซุฉ
- [ ] **ุงููููุงุช**: `/app/api/admin/documents/[id]/route.ts`, `/lib/file-utils.ts`

#### 2.2 ุชุญุณูู ุงูุชุญูู ูู ุงููููุงุช (3-4 ุณุงุนุงุช)
- [ ] ุฅูุดุงุก ุฏุงูุฉ `validateFileContent()` ููุญุต magic bytes
- [ ] ุฏุงูุฉ `sanitizeFilename()`
- [ ] ุฏุงูุฉ `generateSecureFilename()`
- [ ] ุชูููู ุญุฏ ุงูุญุฌู ุฅูู 50MB
- [ ] ุฅุถุงูุฉ placeholder ููุญุต ุงูููุฑูุณุงุช
- [ ] **ุงููููุงุช**: `/app/api/admin/documents/route.ts`, `/lib/file-validation.ts`

**ูุฌููุน ุงูููุช**: ~6 ุณุงุนุงุช

---

### ุงููุฑุญูุฉ 3: ุงูุจููุฉ ุงูุชุญุชูุฉ (ููู 3) ๐ก

**ุงููุฏู**: ุชุญุณูู ุงูุฃูุงู ุงูุนุงู ูุงูุจููุฉ ุงูุชุญุชูุฉ

#### 3.1 ุชุฃููู ุจูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช (2 ุณุงุนุฉ)
- [ ] ุฅูุดุงุก `.env.example`
- [ ] ุฅุถุงูุฉ `.env` ุฅูู `.gitignore`
- [ ] ุชูุซูู ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช
- [ ] ุฏููู ุงุณุชุฎุฏุงู Secrets Manager
- [ ] ุงูุชุญูู ูู ุงููุชุบูุฑุงุช ุนูุฏ ุงูุจุฏุก
- [ ] **ุงููููุงุช**: `.env.example`, `.gitignore`, `docs/security/ENV_SETUP.md`

#### 3.2 ุฅุถุงูุฉ Rate Limiting ู CORS (3-4 ุณุงุนุงุช)
- [ ] ุฅูุดุงุก `/middleware.ts`
- [ ] ุฅุถุงูุฉ rate limiting logic
- [ ] ุฅุนุฏุงุฏ CORS whitelist
- [ ] ุฅุถุงูุฉ security headers
- [ ] ุงุฎุชุจุงุฑ ูุน ุทูุจุงุช ูุชุนุฏุฏุฉ
- [ ] **ุงููููุงุช**: `middleware.ts`, `next.config.js`

**ูุฌููุน ุงูููุช**: ~6 ุณุงุนุงุช

---

### ุงููุฑุญูุฉ 4: ุงูุงุฎุชุจุงุฑ ูุงูุชูุซูู (ููู 4) โ

**ุงููุฏู**: ุงูุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ุจุดูู ุตุญูุญ

#### 4.1 ุงุฎุชุจุงุฑุงุช ุดุงููุฉ (4-5 ุณุงุนุงุช)
- [ ] ุงุฎุชุจุงุฑ ุงููุตุงุฏูุฉ ูุงูุฌูุณุงุช
- [ ] ุงุฎุชุจุงุฑ ุฑูุน ุงููููุงุช ุงูุฎุจูุซุฉ
- [ ] ุงุฎุชุจุงุฑ path traversal
- [ ] ุงุฎุชุจุงุฑ rate limiting
- [ ] ุงุฎุชุจุงุฑ CORS
- [ ] **ุงููููุงุช**: `tests/security/*.test.ts`

#### 4.2 ุงูุชูุซูู (2-3 ุณุงุนุงุช)
- [ ] ุชูุซูู ุฌููุน ุงูุชุบููุฑุงุช
- [ ] ุฏููู ุงููุดุฑ
- [ ] ูุงุฆูุฉ ุงูุชุญูู ููุฅูุชุงุฌ
- [ ] ุฏููู ุงูุงุณุชุฑุฌุงุน (rollback)
- [ ] **ุงููููุงุช**: `docs/security/DEPLOYMENT.md`, `docs/security/ROLLBACK.md`

**ูุฌููุน ุงูููุช**: ~7 ุณุงุนุงุช

---

## ๐ฏ ุงูุฃููููุงุช

### ุฃููููุฉ ูุตูู (ุชูููุฐ ููุฑู) ๐ด
1. **ุฅุตูุงุญ ูููุงุช ุงููุฑูุฑ** - ุฎุทุฑ ููุฑู
2. **ุฅุถุงูุฉ ูุตุงุฏูุฉ ููุฑูุงุจุท** - ุฃู ุดุฎุต ููููู ุงููุตูู ููุฅุฏุงุฑุฉ
3. **ููู ุงูุฌูุณุงุช ููDB** - ุงูุฌูุณุงุช ุชูููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู

### ุฃููููุฉ ุนุงููุฉ (ุฎูุงู 48 ุณุงุนุฉ) ๐
4. **ุฅุตูุงุญ path traversal** - ูููู ุญุฐู ูููุงุช ุงููุธุงู
5. **ุชุญุณูู ุงูุชุญูู ูู ุงููููุงุช** - ูููู ุฑูุน ูููุงุช ุฎุจูุซุฉ

### ุฃููููุฉ ูุชูุณุทุฉ (ุฎูุงู ุฃุณุจูุน) ๐ก
6. **ุชุฃููู ุจูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช** - ุจูุงูุงุช ููุดููุฉ ูู Git
7. **ุฅุถุงูุฉ rate limiting ู CORS** - ุญูุงูุฉ ูู ุงููุฌูุงุช

---

## ๐ฆ ูุชุทูุจุงุช ุงูุชูููุฐ

### ุฃุฏูุงุช ูุทููุจุฉ
- โ Node.js 18+
- โ PostgreSQL 12+
- โ Prisma CLI
- โ Git

### ููุชุจุงุช ุฅุถุงููุฉ ูุทููุจุฉ
```bash
npm install --save crypto
npm install --save @types/node
npm install --save-dev @types/jest jest ts-jest
```

### ูุณุฎ ุงุญุชูุงุทู
- [ ] ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูููุฏ (git tag)
- [ ] ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูููุงุช .env

---

## โฑ๏ธ ุฌุฏูู ุฒููู ููุชุฑุญ

| ุงูููู | ุงููุฑุญูุฉ | ุงูููุช ุงูููุฏุฑ | ุงูุฃููููุฉ |
|------|---------|--------------|----------|
| 1 | ุงููุฑุญูุฉ 1: ุงูุฅุตูุงุญุงุช ุงูููุฑูุฉ | 10 ุณุงุนุงุช | ๐ด ููุฑูุฉ |
| 2 | ุงููุฑุญูุฉ 2: ุญูุงูุฉ ุงููููุงุช | 6 ุณุงุนุงุช | ๐ ุนุงุฌูุฉ |
| 3 | ุงููุฑุญูุฉ 3: ุงูุจููุฉ ุงูุชุญุชูุฉ | 6 ุณุงุนุงุช | ๐ก ูููุฉ |
| 4 | ุงููุฑุญูุฉ 4: ุงูุงุฎุชุจุงุฑ ูุงูุชูุซูู | 7 ุณุงุนุงุช | โ ุชุญูู |

**ุงููุฌููุน ุงูููู**: ~29 ุณุงุนุฉ (3-4 ุฃูุงู ุนูู)

---

## โ ุงุฎุชุจุงุฑ ูุง ุจุนุฏ ุงูุชูููุฐ

### ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

#### 1. ุงููุตุงุฏูุฉ ูุงูุฌูุณุงุช
- [ ] ูุง ูููู ุงููุตูู ูุฑูุงุจุท admin ุจุฏูู ุชุณุฌูู ุฏุฎูู
- [ ] ุงูุฌูุณุงุช ูุญููุธุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุงูุฌูุณุงุช ุชูุชูู ุจุนุฏ 24 ุณุงุนุฉ
- [ ] ูุง ุชูุฌุฏ ูููุงุช ูุฑูุฑ ููุชูุจุฉ ูู ุงูููุฏ
- [ ] ููุทูุจ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุนูุฏ ุฃูู ุฏุฎูู

#### 2. ุงููููุงุช
- [ ] ูุญุต magic bytes ูุนูู (ุฑูุถ ูููุงุช ูุฒููุฉ)
- [ ] ูุง ูููู ุฑูุน ูููุงุช ุฃูุจุฑ ูู 50MB
- [ ] ูุง ูููู ุญุฐู ูููุงุช ุฎุงุฑุฌ ูุฌูุฏ uploads
- [ ] ุฃุณูุงุก ุงููููุงุช ุขููุฉ ูููุธูุฉ

#### 3. ุงูุจููุฉ ุงูุชุญุชูุฉ
- [ ] ููู .env ุบูุฑ ููุฌูุฏ ูู Git
- [ ] .env.example ููุฌูุฏ ููุญุฏุซ
- [ ] Rate limiting ูุนูู (429 ุจุนุฏ 100 ุทูุจ)
- [ ] CORS ูุญูู ูู domains ุบูุฑ ูุตุฑุญ ุจูุง
- [ ] Security headers ููุฌูุฏุฉ

#### 4. ุงูุฃุฏุงุก
- [ ] ุงูุชุทุจูู ูุนูู ุจููุณ ุงูุณุฑุนุฉ (ุฃู ุฃุณุฑุน)
- [ ] ูุง ุชูุฌุฏ ุชุณุฑูุจุงุช ูู ุงูุฐุงูุฑุฉ
- [ ] Logs ุชุณุฌู ุงููุดุงุท ุงููุดุจูู

---

## ๐จ ุฎุทุฉ ุงูุงุณุชุฑุฌุงุน (Rollback)

### ุฅุฐุง ุญุฏุซ ุฎุทุฃ ุญุฑุฌ

#### ุงูุฎุทูุฉ 1: ุฅููุงู ุงููุดุฑ
```bash
# ุฅููุงู ุงูุณูุฑูุฑ
pm2 stop islamic-library

# ุงูุฑุฌูุน ูููุณุฎุฉ ุงูุณุงุจูุฉ
git revert HEAD
```

#### ุงูุฎุทูุฉ 2: ุงุณุชุฑุฌุงุน ูุงุนุฏุฉ ุงูุจูุงูุงุช
```bash
# ุงุณุชุฑุฌุงุน ูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
psql islamic_library < backup_before_security_fixes.sql

# ุฃู ุงูุชุฑุงุฌุน ุนู migrations
npx prisma migrate resolve --rolled-back 20240101_security_fixes
```

#### ุงูุฎุทูุฉ 3: ุงุณุชุฑุฌุงุน .env
```bash
cp .env.backup .env
```

#### ุงูุฎุทูุฉ 4: ุฅุนุงุฏุฉ ุงูุชุดุบูู
```bash
npm run build
pm2 start islamic-library
```

---

## ๐ ููุงุท ุงูุงุชุตุงู

### ุนูุฏ ุญุฏูุซ ูุดุงูู
1. ุฑุงุฌุน `docs/security/TROUBLESHOOTING.md`
2. ุชุญูู ูู logs: `pm2 logs`
3. ุฑุงุฌุน ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู

---

## ๐ ูููุงุช ุฐุงุช ุตูุฉ

- [CRITICAL-FIXES.md](./CRITICAL-FIXES.md) - ุงูุชูุงุตูู ุงูุชูููุฉ ููู ูุดููุฉ
- [DEPLOYMENT.md](./DEPLOYMENT.md) - (ุณูุชู ุฅูุดุงุคู) ุฏููู ุงููุดุฑ
- [ROLLBACK.md](./ROLLBACK.md) - (ุณูุชู ุฅูุดุงุคู) ุฏููู ุงูุงุณุชุฑุฌุงุน
- [ENV_SETUP.md](./ENV_SETUP.md) - (ุณูุชู ุฅูุดุงุคู) ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช

---

## โ๏ธ ููุงุญุธุงุช ููุงุฆูุฉ

### ูุจู ุงูุจุฏุก
- [ ] ุงูุฑุฃ ูุฐู ุงูุฎุทุฉ ูุงููุฉ
- [ ] ุงููู ูู ูุดููุฉ ูุญููุง
- [ ] ุฌูุฒ ุงูุจูุฆุฉ ูุงูุฃุฏูุงุช
- [ ] ุฎุฐ ูุณุฎ ุงุญุชูุงุทูุฉ

### ุฃุซูุงุก ุงูุชูููุฐ
- [ ] ุงุชุจุน ุงูุชุฑุชูุจ ุงููุญุฏุฏ
- [ ] ุงุฎุชุจุฑ ุจุนุฏ ูู ุชุบููุฑ
- [ ] ูุซู ุฃู ูุดุงูู ุชูุงุฌููุง
- [ ] ูุง ุชุชุฎุทู ุงูุฎุทูุงุช

### ุจุนุฏ ุงูุงูุชูุงุก
- [ ] ุงุฎุชุจุงุฑ ุดุงูู
- [ ] ูุฑุงุฌุนุฉ ุงูููุฏ
- [ ] ุชุญุฏูุซ ุงูุชูุซูู
- [ ] ูุดุฑ ูู ุงูุฅูุชุงุฌ

---

**ุขุฎุฑ ุชุญุฏูุซ**: 20 ููุงูุฑ 2026
**ุงูุฅุตุฏุงุฑ**: 1.0
**ุงูุญุงูุฉ**: โณ ุฌุงูุฒ ููุชูููุฐ
