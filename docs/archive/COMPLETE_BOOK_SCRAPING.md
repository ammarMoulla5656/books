# โ ูุธุงู ุงุณุชุฎุฑุงุฌ ุงููุชุจ ุงููุงููุฉ | Complete Book Scraping System

**ุงูุชุงุฑูุฎ**: 3 ููุงูุฑ 2026

---

## ๐ฏ ุงููุฏู

ุงุณุชุฎุฑุงุฌ **ุฌููุน** ูุญุชููุงุช ูุชุจ ุงููุฑุฌุน ุงูุณูุณุชุงูู ูู ุงููููุน ุงูุฑุณูู ุจุดูู **ุญุฑูู ูุฏููู** ูุน ุงูุญูุงุธ ุนูู:
- โ ุงูุชุฑุชูุจ ุงูุฃุตูู ูููุตูู
- โ ุฌููุน ุงููุณุงุฆู ูุงูุชูุงุตูู
- โ ุงููุตูุต ุงููุงููุฉ ุจุฏูู ุงุฎุชุตุงุฑ
- โ ุงูุจููุฉ ุงููุฑููุฉ ูููุญุชูู

---

## ๐ง ุงูุฃุฏูุงุช ุงููุชููุฑุฉ

### 1. API Endpoint ููุงุณุชุฎุฑุงุฌ ุงูุชููุงุฆู

**ุงููุณุงุฑ**: `/api/admin/scrape-book/[bookId]`

**ุงูุงุณุชุฎุฏุงู**:
```bash
# ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุน 20 ูุตู
curl -X POST http://localhost:3000/api/admin/scrape-book/13 \
  -H "Content-Type: application/json" \
  -d '{"maxChapters": 20}'

# ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุน 50 ูุตู
curl -X POST http://localhost:3000/api/admin/scrape-book/14 \
  -H "Content-Type: application/json" \
  -d '{"maxChapters": 50}'

# ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุงูู (200 ูุตู)
curl -X POST http://localhost:3000/api/admin/scrape-book/15 \
  -H "Content-Type: application/json" \
  -d '{"maxChapters": 200}'
```

**ุงููููุฒุงุช**:
- โ ุงุณุชุฎุฑุงุฌ ุชููุงุฆู ูู ุงููููุน
- โ ุญูุธ ูุจุงุดุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ูุนุงูุฌุฉ HTML ูุชูุธูู ุงููุตูุต
- โ ุฏุนู ุฌููุน ุงููุชุจ

---

## ๐ ุงููุชุจ ุงููุชุงุญุฉ

| ID | ุงุณู ุงููุชุงุจ | ุงูุญุงูุฉ |
|---|---|---|
| 13 | ุงููุณุงุฆู ุงูููุชุฎุจุฉ | โ ุชู (20 ูุตู) |
| 14 | ููุงุณู ุงูุญุฌ ูููุญูุงุชูุง | โณ ูุชุงุญ |
| 15 | ูููุงุฌ ุงูุตุงูุญูู ู ุงูุฌุฒุก ุงูุซุงูู | โณ ูุชุงุญ |
| 16 | ูููุงุฌ ุงูุตุงูุญูู ู ุงูุฌุฒุก ุงูุซุงูุซ | โณ ูุชุงุญ |
| 17 | ุงูููู ูููุบุชุฑุจูู | โณ ูุชุงุญ |
| 18 | ุงูููุณูุฑ ูู ุงูุญุฌ ูุงูุนูุฑุฉ | โณ ูุชุงุญ |
| 19 | ุงููุชุงูู ุงูููุณููุฑุฉ | โณ ูุชุงุญ |
| 22 | ุงูุชุนูููุฉ ุนูู ุงูุนุฑูุฉ ุงููุซูู ู ุฌ1 | โณ ูุชุงุญ |
| 23 | ุงูุชุนูููุฉ ุนูู ุงูุนุฑูุฉ ุงููุซูู ู ุฌ2 | โณ ูุชุงุญ |
| 24 | ุงููุฌูุฒ ูู ุฃุญูุงู ุงูุนุจุงุฏุงุช | โณ ูุชุงุญ |
| 23720 | ูููุงุฌ ุงูุตุงูุญูู ู ุงูุฌุฒุก ุงูุฃูู | โณ ูุชุงุญ |
| 26278 | ุงูุตูุงู ุฌููุฉ ูู ุงููุงุฑ | โณ ูุชุงุญ |

---

## ๐ ุทุฑููุฉ ุงูุงุณุชุฎุฑุงุฌ ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุงุญุฏ

```bash
# ูุซุงู: ุงุณุชุฎุฑุงุฌ "ููุงุณู ุงูุญุฌ" ูุน 30 ูุตู
curl -X POST http://localhost:3000/api/admin/scrape-book/14 \
  -H "Content-Type: application/json" \
  -d '{"maxChapters": 30}'
```

**ุงููุชูุฌุฉ**:
```json
{
  "success": true,
  "message": "ุชู ุงุณุชุฎุฑุงุฌ ุงููุชุงุจ ุจูุฌุงุญ",
  "book": {
    "id": "xxx",
    "title": "ููุงุณู ุงูุญุฌ ูููุญูุงุชูุง",
    "author": "ุขูุฉ ุงููู ุงูุนุธูู ุงูุณูุฏ ุนูู ุงูุญุณููู ุงูุณูุณุชุงูู",
    "chaptersCount": 30,
    "sectionsCount": 30
  }
}
```

### ุงูุฎุทูุฉ 2: ุงุณุชุฎุฑุงุฌ ุฌููุน ุงููุชุจ

ููููู ุฅูุดุงุก ุณูุฑูุจุช bash ูุงุณุชุฎุฑุงุฌ ุฌููุน ุงููุชุจ:

```bash
#!/bin/bash
# ุงุณุชุฎุฑุงุฌ ุฌููุน ุงููุชุจ

BOOKS="13 14 15 16 17 18 19 22 23 24 23720 26278"

for BOOK_ID in $BOOKS; do
  echo "๐ ุงุณุชุฎุฑุงุฌ ุงููุชุงุจ $BOOK_ID..."

  curl -X POST "http://localhost:3000/api/admin/scrape-book/$BOOK_ID" \
    -H "Content-Type: application/json" \
    -d '{"maxChapters": 100}' \
    -s | jq '.'

  echo "โ ุชู ุงููุชุงุจ $BOOK_ID"
  echo ""

  # ุชุฃุฎูุฑ ุจูู ุงููุชุจ
  sleep 5
done

echo "๐ ุชู ุงุณุชุฎุฑุงุฌ ุฌููุน ุงููุชุจ!"
```

---

## ๐ ุขููุฉ ุงูุนูู

### 1. ุงุณุชุฎุฑุงุฌ ูุงุฆูุฉ ุงููุตูู
```typescript
// ูู ุตูุญุฉ ุงููุชุงุจ ุงูุฑุฆูุณูุฉ
const bookPageUrl = `https://www.sistani.org/arabic/book/${bookId}/`;
const html = await fetch(bookPageUrl).then(r => r.text());

// ุงุณุชุฎุฑุงุฌ ุฑูุงุจุท ุงููุตูู
const chapterRegex = new RegExp(`href="/arabic/book/${bookId}/(\\d+)/">`, 'g');
```

### 2. ุงุณุชุฎุฑุงุฌ ูุญุชูู ูู ูุตู
```typescript
for (const chapterId of chapterIds) {
  const chapterUrl = `https://www.sistani.org/arabic/book/${bookId}/${chapterId}/`;
  const chapterHtml = await fetch(chapterUrl).then(r => r.text());

  // ุงุณุชุฎุฑุงุฌ ุงูุนููุงู ูุงููุญุชูู
  const title = extractTitle(chapterHtml);
  const content = extractContent(chapterHtml);

  chapters.push({ title, content, order });
}
```

### 3. ุชูุธูู ูุญูุธ ุงูุจูุงูุงุช
```typescript
// ุชูุธูู HTML
content = content
  .replace(/<script[^>]*>[\s\S]*?<\/script>/gi, '')
  .replace(/<[^>]*>/g, '')
  .replace(/&nbsp;/g, ' ')
  .trim();

// ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
await prisma.book.create({
  data: {
    title, author, categoryId,
    chapters: {
      create: chapters.map(ch => ({
        title: ch.title,
        order: ch.order,
        sections: {
          create: [{ title: ch.title, content: ch.content, order: 1 }]
        }
      }))
    }
  }
});
```

---

## ๐ ุงูุชุญูู ูู ุงูุจูุงูุงุช

### ุทุฑููุฉ 1: ุนุจุฑ API
```bash
# ุงูุญุตูู ุนูู ุฌููุน ุงููุชุจ
curl http://localhost:3000/api/books | jq '.[] | {title, chapters: (.chapters | length)}'
```

### ุทุฑููุฉ 2: ุนุจุฑ ุงููููุน
1. ุงูุชุญ http://localhost:3000
2. ุงุจุญุซ ุนู ุงููุชุงุจ ุงููุณุชุฎุฑุฌ
3. ุงูุชุญ ุงููุชุงุจ ูุชุญูู ูู ุงููุตูู

### ุทุฑููุฉ 3: ุนุจุฑ Prisma Studio
```bash
npx prisma studio
```
- ุงูุชุญ ุฌุฏูู `books`
- ุงุจุญุซ ุนู ุงููุชุงุจ
- ุงูุชุญ `chapters` ู `sections` ููุชุญูู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงูุญุงููุฉ

### ุงููุชุจ ุงููุณุชูุฑุฏุฉ ุญุชู ุงูุขู:

**1. ูููุงุฌ ุงูุตุงูุญูู ู ุงูุฌุฒุก ุงูุฃูู** (ูุฏูู)
- ุงููุตูู: 3
- ุงููุณุงุฆู: 11

**2. ูููุงุฌ ุงูุตุงูุญูู ู ุงูุฌุฒุก ุงูุซุงูู** (ูุฏูู)
- ุงููุตูู: 2
- ุงููุณุงุฆู: 5

**3. ูููุงุฌ ุงูุตุงูุญูู ู ุงูุฌุฒุก ุงูุซุงูุซ** (ูุฏูู)
- ุงููุตูู: 3
- ุงููุณุงุฆู: 8

**4. ุงููุณุงุฆู ุงูููุชุฎุจุฉ** (ูุฏูู)
- ุงููุตูู: 2
- ุงููุณุงุฆู: 4

**5. ููุงุณู ุงูุญุฌ ูููุญูุงุชูุง** (ูุฏูู)
- ุงููุตูู: 3
- ุงููุณุงุฆู: 7

**6. ุงููุณุงุฆู ุงูููุชุฎุจุฉ** (ุขูู - ูุงูู)
- ุงููุตูู: 20 โ
- ุงููุญุชูู: ูุงูู ูู ุงููููุน โ

---

## ๐ฏ ุงูุฎุทุฉ ูุงุณุชููุงู ุฌููุน ุงููุชุจ

### ุงููุฑุญูุฉ 1: ุงููุชุจ ุงูุฃุณุงุณูุฉ (ุฃููููุฉ ุนุงููุฉ)
```bash
# 1. ูููุงุฌ ุงูุตุงูุญูู - ุงูุฃุฌุฒุงุก ุงูุซูุงุซุฉ
curl -X POST http://localhost:3000/api/admin/scrape-book/23720 -H "Content-Type: application/json" -d '{"maxChapters": 100}'
curl -X POST http://localhost:3000/api/admin/scrape-book/15 -H "Content-Type: application/json" -d '{"maxChapters": 100}'
curl -X POST http://localhost:3000/api/admin/scrape-book/16 -H "Content-Type: application/json" -d '{"maxChapters": 100}'

# 2. ููุงุณู ุงูุญุฌ
curl -X POST http://localhost:3000/api/admin/scrape-book/14 -H "Content-Type: application/json" -d '{"maxChapters": 50}'
```

### ุงููุฑุญูุฉ 2: ุงููุชุจ ุงููุชุฎุตุตุฉ
```bash
# 3. ุงููุชุงูู ุงูููุณูุฑุฉ
curl -X POST http://localhost:3000/api/admin/scrape-book/19 -H "Content-Type: application/json" -d '{"maxChapters": 80}'

# 4. ุงูููู ูููุบุชุฑุจูู
curl -X POST http://localhost:3000/api/admin/scrape-book/17 -H "Content-Type: application/json" -d '{"maxChapters": 60}'
```

### ุงููุฑุญูุฉ 3: ุงููุชุจ ุงูุชูููููุฉ
```bash
# 5-8. ุจุงูู ุงููุชุจ
curl -X POST http://localhost:3000/api/admin/scrape-book/18 -H "Content-Type: application/json" -d '{"maxChapters": 40}'
curl -X POST http://localhost:3000/api/admin/scrape-book/24 -H "Content-Type: application/json" -d '{"maxChapters": 50}'
curl -X POST http://localhost:3000/api/admin/scrape-book/22 -H "Content-Type: application/json" -d '{"maxChapters": 100}'
curl -X POST http://localhost:3000/api/admin/scrape-book/23 -H "Content-Type: application/json" -d '{"maxChapters": 100}'
```

---

## โ๏ธ ุฅุนุฏุงุฏุงุช ูููุฉ

### ุญุฏ ุงููุญุชูู
ุญุงููุงู ูู ูุตู ูุญุฏูุฏ ุจู **10,000 ุญุฑู**:
```typescript
content: content.substring(0, 10000)
```

**ูุฅุฒุงูุฉ ุงูุญุฏ** (ุงุณุชุฎุฑุงุฌ ุงููุญุชูู ูุงููุงู):
```typescript
content: content // ุจุฏูู substring
```

### ุงูุชุฃุฎูุฑ ุจูู ุงูุทูุจุงุช
ุญุงููุงู **500ms** ุจูู ูู ูุตู:
```typescript
await new Promise(resolve => setTimeout(resolve, 500));
```

**ููุงุณุชุฎุฑุงุฌ ุงูุฃุณุฑุน** (ุบูุฑ ููุตู ุจู):
```typescript
await new Promise(resolve => setTimeout(resolve, 200));
```

**ููุงุณุชุฎุฑุงุฌ ุงูุขูู ุฌุฏุงู**:
```typescript
await new Promise(resolve => setTimeout(resolve, 1000));
```

---

## ๐ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ูุดููุฉ: ุงููุชุงุจ ูู ูุชู ุงุณุชุฎุฑุงุฌู ุจุงููุงูู
**ุงูุญู**: ุฒูุงุฏุฉ `maxChapters`
```bash
curl -X POST http://localhost:3000/api/admin/scrape-book/13 \
  -H "Content-Type: application/json" \
  -d '{"maxChapters": 200}'
```

### ูุดููุฉ: ุงููุญุชูู ููุทูุน
**ุงูุญู**: ุฅุฒุงูุฉ ุญุฏ ุงูู 10000 ุญุฑู ูู ุงูููุฏ:
```typescript
// ูู /app/api/admin/scrape-book/[bookId]/route.ts
content: content // ุจุฏูุงู ูู content.substring(0, 10000)
```

### ูุดููุฉ: ุงููููุน ูุญุธุฑ ุงูุทูุจุงุช
**ุงูุญู**: ุฒูุงุฏุฉ ุงูุชุฃุฎูุฑ ุจูู ุงูุทูุจุงุช:
```typescript
await new Promise(resolve => setTimeout(resolve, 2000)); // 2 ุซุงููุฉ
```

---

## ๐ ุณูุฑูุจุช ุงุณุชุฎุฑุงุฌ ุฌููุน ุงููุชุจ

ุญูุธ ูุฐุง ูู `extract-all-books.sh`:

```bash
#!/bin/bash
echo "๐ ุจุณู ุงููู ุงูุฑุญูู ุงูุฑุญูู"
echo "๐ ุจุฏุก ุงุณุชุฎุฑุงุฌ ุฌููุน ูุชุจ ุงููุฑุฌุน ุงูุณูุณุชุงูู..."
echo ""

BOOKS=(
  "23720:ูููุงุฌ ุงูุตุงูุญูู ุฌ1:100"
  "15:ูููุงุฌ ุงูุตุงูุญูู ุฌ2:100"
  "16:ูููุงุฌ ุงูุตุงูุญูู ุฌ3:100"
  "14:ููุงุณู ุงูุญุฌ:50"
  "19:ุงููุชุงูู ุงูููุณุฑุฉ:80"
  "17:ุงูููู ูููุบุชุฑุจูู:60"
  "18:ุงูููุณุฑ ูู ุงูุญุฌ:40"
  "24:ุงููุฌูุฒ ูู ุงูุนุจุงุฏุงุช:50"
  "22:ุงูุชุนูููุฉ ุฌ1:100"
  "23:ุงูุชุนูููุฉ ุฌ2:100"
  "26278:ุงูุตูุงู ุฌูุฉ ูู ุงููุงุฑ:30"
)

for BOOK_INFO in "${BOOKS[@]}"; do
  IFS=: read -r BOOK_ID BOOK_NAME MAX_CHAPTERS <<< "$BOOK_INFO"

  echo "================================"
  echo "๐ $BOOK_NAME (ID: $BOOK_ID)"
  echo "================================"

  curl -X POST "http://localhost:3000/api/admin/scrape-book/$BOOK_ID" \
    -H "Content-Type: application/json" \
    -d "{\"maxChapters\": $MAX_CHAPTERS}" \
    -s | jq -r '.message, .book | @json'

  echo ""
  echo "โ ุชู ุงุณุชุฎุฑุงุฌ $BOOK_NAME"
  echo ""

  # ุชุฃุฎูุฑ 10 ุซูุงูู ุจูู ุงููุชุจ
  sleep 10
done

echo ""
echo "๐ ุงูุชูู ุงุณุชุฎุฑุงุฌ ุฌููุน ุงููุชุจ!"
echo "๐ ุชุญูู ูู ุงููุชุงุฆุฌ ูู: http://localhost:3000"
```

**ุงูุงุณุชุฎุฏุงู**:
```bash
chmod +x extract-all-books.sh
./extract-all-books.sh
```

---

## โ ุงูุฎูุงุตุฉ

ุชู ุฅูุดุงุก ูุธุงู ูุชูุงูู ูุงุณุชุฎุฑุงุฌ **ุฌููุน** ูุชุจ ุงููุฑุฌุน ุงูุณูุณุชุงูู ูู ุงููููุน ุงูุฑุณูู ูุน:

โ **ุงุณุชุฎุฑุงุฌ ุชููุงุฆู** ุนุจุฑ API
โ **ูุญุชูู ูุงูู** ูู ุงููููุน
โ **ุชุฑุชูุจ ุตุญูุญ** ูููุตูู
โ **ุญูุธ ูุจุงุดุฑ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ **ุณูู ุงูุงุณุชุฎุฏุงู** - ูุฌุฑุฏ curl request!

**ุงูุขู ููููู ุงุณุชุฎุฑุงุฌ ุฃู ูุชุงุจ ุจุฃูุฑ ูุงุญุฏ ููุท!**

---

**๐ ุจุณู ุงููู ุงูุฑุญูู ุงูุฑุญูู**

**ูุธุงู ุงูุงุณุชุฎุฑุงุฌ ุฌุงูุฒ ูุฌููุน ุงููุชุจ ูุชุงุญุฉ ููุงุณุชุฎุฑุงุฌ!**

*Last Updated: January 3, 2026*
